---
title: "SQL"
output: html_document
---

## Filtering Columns and Rows

With SQL, you can filter columns with SELECT and rows with WHERE. Let's try an example with the Lahman baseball database. First, we need to load the appropiate packakges. 

```{r warning=FALSE, message=FALSE}
library(Lahman)
library(sqldf)
```
******
Now, suppose we would like to see the homerun totals for the 1927 Yankees. We would write the following.

```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE teamID='NYA' and yearID=1927"
sqldf(query)
```
******
Find all instances where Yankees have hut 40 homeruns or more
```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE teamID='NYA' and HR>39"
sqldf(query)
```
******
Find all examples where a player had more than 40 homeruns but less than 60 strikeouts
```{r}
query<-"SELECT playerID,yearID,teamID,HR,SO FROM Batting
WHERE SO<60 and HR>40"
sqldf(query)
```
******
Find all instances of Phillies (PHI) in the 1970’s hitting more than 30 homeruns
```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE teamID='PHI' and HR>30 and yearID>=1970 and yearID<=1979"
sqldf(query)
```
******
##Ordering Rows

Find every instance of a player hitting more than 50 homeruns, but let’s have the players with the most homeruns at the top
```{r}
query<-"SELECT playerID,teamID,yearID,HR FROM Batting
WHERE HR>50
ORDER BY HR DESC"
sqldf(query)
```
******
Find all instances of a player striking out less than 10 times. Make sure each player had at least 400 at-bats (AB). Players with least strikeouts at the top
```{r}
query<-"SELECT playerID,teamID,yearID,SO,AB FROM Batting
WHERE SO<10 and AB>=400
ORDER BY SO"
sqldf(query)
```
******